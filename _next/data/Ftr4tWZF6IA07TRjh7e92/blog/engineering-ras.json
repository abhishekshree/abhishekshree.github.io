{"pageProps":{"post":{"mdxSource":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"The work is done for Students' Placement Office, IIT Kanpur.\"), mdx(\"p\", null, \"Leave a star if you appreciate the work :P\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/spo-iitk/ras-backend\"\n  }, \"Backend\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/spo-iitk/ras-frontend\"\n  }, \"Frontend\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/spo-iitk/ras-cdn\"\n  }, \"CDN\"))), mdx(\"h2\", {\n    \"id\": \"assessing-the-problem\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#assessing-the-problem\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Assessing the Problem\"), mdx(\"p\", null, \"It started back in December 2021 when I got to work and improve the existing recruitment portal. We ran several security, stress, performance, and scalability tests on the portal. As a result, several vulnerabilities and performance issues were found. The was pretty well built to serve its purpose in 2014, but times have changed. We cannot have a deprecated Django version on the server sending complete HTML pages on API calls now. Moreover, operating on one thread with blocking synchronous requests, like emailing and zipping files would have never improved the performance.\"), mdx(\"h2\", {\n    \"id\": \"our-solution\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#our-solution\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Our Solution\"), mdx(\"p\", null, \"I along with \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://1-harshit.github.io/\"\n  }, \"Harshit Raj\"), \" figured out the exact process of recruitment and tried to simplify it. For our product we discussed multiple backend architecture possibilities and finalized a microservices-based arch having 9 microservices and a Relational Database Model, more on that in the next section. Along with independent primary services like managing a recruitment phase, students, proformas and applications, we also implementated an asychronous emailing service, a CDN for the resume storage, and zipping service with caching. Kept the frontend completely independent from the backend. We also ensured a rigourous multi-staged logging system on the backend and the Nignx reverse proxy.\"), mdx(\"p\", null, \"Technologies used on the backend include, go, gin, gorm, postgres, jwt, along with a context-based model throughout the system. On the frontend, we used Next.js, TypeScript, Zustand, Material UI, along with several dev tools like Eslint and Prettier.\"), mdx(\"p\", null, \"We ensured that the codebase is modular, consistent, and idiomatic throughout.\"), mdx(\"h2\", {\n    \"id\": \"architecture\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#architecture\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Architecture\"), mdx(\"p\", null, \"The complete product architecture can be broadly dividied into these parts:\"), mdx(\"h3\", {\n    \"id\": \"the-backend\"\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#the-backend\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"The Backend\"), mdx(\"p\", null, \"The backend was implementated keeping in mind a context-based model which allows us to pass request-scoped values, cancelation signals, and deadlines across API boundaries to all the goroutines involved in handling a request. We used \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gin\"), \" as the HTTP framework and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gorm\"), \" as the ORM. The databases were designed keeping in mind the independence of each microservice. We used a total of 5 databases loosely tied to each other with keys to link them together. Indexes were used appropriately to make the queries faster. We had to use extensive joins to filter out data relevant to the end users, even across databases sometimes. \"), mdx(\"p\", null, \"We ensured panic recovery and error handling throughout the backend. Another important aspect was to keep logs of every important action performed at the admin end, so that we could track them back if needed, and also, to keep a record of the backend performance.\"), mdx(\"p\", null, \"Let's look at another interesting design choice by this example, instead of assigning students to different sets of events available for a certain job position (say resume verification, GD, etc.) we chose to go for a model with unique events for every job position and mapping it uniquely to the students. A very neat way to convert an obvious looking NoSQL looking model to a relational one.\"), mdx(\"h3\", {\n    \"id\": \"cdn\"\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#cdn\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"CDN\"), mdx(\"p\", null, \"Another significant aspect of making the backend robust was to separate the logic to serve static files from the main server. We approached for the solution of this problem by considering the usage of AWS S3 along with a CloudFront CDN initially to serve the files efficiently.\"), mdx(\"center\", null, mdx(\"img\", {\n    alt: \"AWS CDN\",\n    src: \"https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2018/06/27/4-v-2.png\"\n  }), mdx(\"span\", null, mdx(\"u\", null, \"AWS based CDN\"))), mdx(\"p\", null, \"But this approach had a few drawbacks and a major blocker in our use case. A drawback was the lack of any computational power at the file server which left us with no option to compress a bunch of files based on our needs. The blocker was the recurring cost to be paid as the AWS charges, which our team was not capable of paying.\"), mdx(\"p\", null, \"Under these circumstances, we decided to set up a local server independent of the backend within the VM itself to serve the files. This saved us around 30,000 INR per year and a redundant zipping service. \"), mdx(\"p\", null, \"The primary idea was to leverage the context-model used (it is really powerful) and leverage the fact that file sharing via HTTP works over a TCP connection. This enabled us to cache the files shared on browser, cancelation of request in case of reload, failure, and a security on the exposed folder to prevent unauthorized access. Zipping process is carried out asychronously and the zipped file information is cached to be reused if needed. This level of caching is definitly not at par CloudFront, but yeah meets our requirements pretty well and saves quite a lot of money.  \"), mdx(\"h3\", {\n    \"id\": \"deployment\"\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#deployment\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Deployment\"), mdx(\"p\", null, \"While deploying the complete backend, Nginx was used as the reverse proxy and the complete backend was deployed over a Docker swarm. Deploying the backend was pretty challenging in itself as we had a lot of dependencies all along. \"), mdx(\"p\", null, \"In a standard practice of deploying a backend over Nginx as the reverse proxy, it is a standard to use all the exposed ports of the backend in the VM first and then proxy the ports on the VM via Nginx. We didn't want that, imagine having 9 ports open on the VM just to proxy them on the Nginx server. \"), mdx(\"p\", null, \"Instead, we accepted the cost of having a bit heavier Docker image for the backend, started the backend on the image, along with Nginx exposing just one port from the VM. Voila!\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"/static/images/deployment.png\",\n    \"alt\": \"deployment\"\n  })), mdx(\"h3\", {\n    \"id\": \"frontend\"\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#frontend\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Frontend\"), mdx(\"p\", null, \"We built the frontend to be at par with the backend. Keeping in mind the responsiveness, SEO and a modern UI design, we decided to use Next.js as the frontend framework. We used TypeScript, Zustand, Material UI, and several dev tools like Eslint and Prettier along the way. \"), mdx(\"p\", null, \"To mention some of the key features of our frontend, we have:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Type-Based API calls.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Method to filter and export data.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A real time update and notification system.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A persistent global state.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Lazy Loading for heavy components.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Page-level authorization and layout.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"RTE Support\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Consistent Global Theming.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"We're also parsing the program-department data optimally using a bit vector directly on the frontend.\")), mdx(\"p\", null, \"Overall it has been a pretty decent upgrade from what we had previously.\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>The work is done for Students&#x27; Placement Office, IIT Kanpur.</p><p>Leave a star if you appreciate the work :P</p><ul><li><a target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none\" href=\"https://github.com/spo-iitk/ras-backend\">Backend</a></li><li><a target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none\" href=\"https://github.com/spo-iitk/ras-frontend\">Frontend</a></li><li><a target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none\" href=\"https://github.com/spo-iitk/ras-cdn\">CDN</a></li></ul><h2 id=\"assessing-the-problem\"><a href=\"#assessing-the-problem\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>Assessing the Problem</h2><p>It started back in December 2021 when I got to work and improve the existing recruitment portal. We ran several security, stress, performance, and scalability tests on the portal. As a result, several vulnerabilities and performance issues were found. The was pretty well built to serve its purpose in 2014, but times have changed. We cannot have a deprecated Django version on the server sending complete HTML pages on API calls now. Moreover, operating on one thread with blocking synchronous requests, like emailing and zipping files would have never improved the performance.</p><h2 id=\"our-solution\"><a href=\"#our-solution\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>Our Solution</h2><p>I along with <a target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none\" href=\"https://1-harshit.github.io/\">Harshit Raj</a> figured out the exact process of recruitment and tried to simplify it. For our product we discussed multiple backend architecture possibilities and finalized a microservices-based arch having 9 microservices and a Relational Database Model, more on that in the next section. Along with independent primary services like managing a recruitment phase, students, proformas and applications, we also implementated an asychronous emailing service, a CDN for the resume storage, and zipping service with caching. Kept the frontend completely independent from the backend. We also ensured a rigourous multi-staged logging system on the backend and the Nignx reverse proxy.</p><p>Technologies used on the backend include, go, gin, gorm, postgres, jwt, along with a context-based model throughout the system. On the frontend, we used Next.js, TypeScript, Zustand, Material UI, along with several dev tools like Eslint and Prettier.</p><p>We ensured that the codebase is modular, consistent, and idiomatic throughout.</p><h2 id=\"architecture\"><a href=\"#architecture\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>Architecture</h2><p>The complete product architecture can be broadly dividied into these parts:</p><h3 id=\"the-backend\"><a href=\"#the-backend\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>The Backend</h3><p>The backend was implementated keeping in mind a context-based model which allows us to pass request-scoped values, cancelation signals, and deadlines across API boundaries to all the goroutines involved in handling a request. We used <code>gin</code> as the HTTP framework and <code>gorm</code> as the ORM. The databases were designed keeping in mind the independence of each microservice. We used a total of 5 databases loosely tied to each other with keys to link them together. Indexes were used appropriately to make the queries faster. We had to use extensive joins to filter out data relevant to the end users, even across databases sometimes. </p><p>We ensured panic recovery and error handling throughout the backend. Another important aspect was to keep logs of every important action performed at the admin end, so that we could track them back if needed, and also, to keep a record of the backend performance.</p><p>Let&#x27;s look at another interesting design choice by this example, instead of assigning students to different sets of events available for a certain job position (say resume verification, GD, etc.) we chose to go for a model with unique events for every job position and mapping it uniquely to the students. A very neat way to convert an obvious looking NoSQL looking model to a relational one.</p><h3 id=\"cdn\"><a href=\"#cdn\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>CDN</h3><p>Another significant aspect of making the backend robust was to separate the logic to serve static files from the main server. We approached for the solution of this problem by considering the usage of AWS S3 along with a CloudFront CDN initially to serve the files efficiently.</p><center><img alt=\"AWS CDN\" src=\"https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2018/06/27/4-v-2.png\"/><span><u>AWS based CDN</u></span></center><p>But this approach had a few drawbacks and a major blocker in our use case. A drawback was the lack of any computational power at the file server which left us with no option to compress a bunch of files based on our needs. The blocker was the recurring cost to be paid as the AWS charges, which our team was not capable of paying.</p><p>Under these circumstances, we decided to set up a local server independent of the backend within the VM itself to serve the files. This saved us around 30,000 INR per year and a redundant zipping service. </p><p>The primary idea was to leverage the context-model used (it is really powerful) and leverage the fact that file sharing via HTTP works over a TCP connection. This enabled us to cache the files shared on browser, cancelation of request in case of reload, failure, and a security on the exposed folder to prevent unauthorized access. Zipping process is carried out asychronously and the zipped file information is cached to be reused if needed. This level of caching is definitly not at par CloudFront, but yeah meets our requirements pretty well and saves quite a lot of money.  </p><h3 id=\"deployment\"><a href=\"#deployment\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>Deployment</h3><p>While deploying the complete backend, Nginx was used as the reverse proxy and the complete backend was deployed over a Docker swarm. Deploying the backend was pretty challenging in itself as we had a lot of dependencies all along. </p><p>In a standard practice of deploying a backend over Nginx as the reverse proxy, it is a standard to use all the exposed ports of the backend in the VM first and then proxy the ports on the VM via Nginx. We didn&#x27;t want that, imagine having 9 ports open on the VM just to proxy them on the Nginx server. </p><p>Instead, we accepted the cost of having a bit heavier Docker image for the backend, started the backend on the image, along with Nginx exposing just one port from the VM. Voila!</p><p><img src=\"/static/images/deployment.png\" alt=\"deployment\"/></p><h3 id=\"frontend\"><a href=\"#frontend\" aria-hidden=\"true\" tabindex=\"-1\"><span class=\"icon icon-link\"></span></a>Frontend</h3><p>We built the frontend to be at par with the backend. Keeping in mind the responsiveness, SEO and a modern UI design, we decided to use Next.js as the frontend framework. We used TypeScript, Zustand, Material UI, and several dev tools like Eslint and Prettier along the way. </p><p>To mention some of the key features of our frontend, we have:</p><ul><li>Type-Based API calls.</li><li>Method to filter and export data.</li><li>A real time update and notification system.</li><li>A persistent global state.</li><li>Lazy Loading for heavy components.</li><li>Page-level authorization and layout.</li><li>RTE Support</li><li>Consistent Global Theming.</li><li>We&#x27;re also parsing the program-department data optimally using a bit vector directly on the frontend.</li></ul><p>Overall it has been a pretty decent upgrade from what we had previously.</p>","scope":{}},"frontMatter":{"wordCount":1036,"readingTime":{"text":"6 min read","minutes":5.17,"time":310200,"words":1034},"slug":"engineering-ras","fileName":"engineering-ras.mdx","title":"Engineering the Recruitment Automation System","date":"2022-07-02","tags":["system design","go","product"],"draft":false,"summary":"Discussed the design and implementational complexity behind the new Recruitment Automation System.","images":[]}},"prev":{"title":"ROS - A Primer","date":"2022-06-28","tags":["ROS","Linux"],"draft":false,"summary":"Discussed the essentials of ROS for a smoother learning curve.","images":[],"slug":"ros-a-primer"},"next":{"title":"Don't like Rust? Use some CLI tools written in it once.","date":"2022-10-14","tags":["rust","linux","cli"],"draft":false,"summary":"🦀 appreciation era","images":[],"slug":"dont-like-rust-use-some-cli-tools-written-in-it-once"}},"__N_SSG":true}